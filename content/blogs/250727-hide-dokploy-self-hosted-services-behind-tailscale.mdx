export const metadata = {
    title: "Hide Dokploy self-hosted services behind TailScale",
    publishDate: "2025-07-27",
    description: ".",
    category: "Tutorial",
    cover_image: "https://images.pexels.com/photos/1181671/pexels-photo-1181671.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
};

import { Callout } from "@/components/mdx/callout";

# What & Why
{/* TODO new section name */}
{/* TODO Skip this section button */}
{/* TODO context */}

## Dokploy

[Dokploy](https://dokploy.com/) is an open-source, self-hostable deployment platform that simplifies the process of managing and deploying applications. 

It acts as an alternative to services like [Heroku](https://www.heroku.com/), [Vercel](https://vercel.com/), and [Netlify](https://www.netlify.com/), providing developers with full control over their deployment pipelines and hosting environments. 

Dokploy leverages [Docker](https://www.docker.com/) and [Traefik](https://traefik.io/) for robust container management, offering features such as flexible application deployment using various builders ([Nixpacks](https://nixpacks.com/), [Heroku Buildpacks](https://devcenter.heroku.com/articles/buildpacks), custom Dockerfiles), native [Docker Compose](https://docs.docker.com/compose/) support, database management with backups (for [MySQL](https://www.mysql.com/), [PostgreSQL](https://www.postgresql.org/), [MongoDB](https://www.mongodb.com/), [MariaDB](https://mariadb.org/), [Redis](https://redis.io/)), real-time monitoring, and API/CLI access. 

It's designed to provide simplicity, flexibility, and scalability for a wide range of applications and databases, allowing users to deploy to single or multiple remote servers.

## Traefik
[Traefik](https://traefik.io/) is an open-source [Edge Router](https://www.cisco.com/site/us/en/learn/topics/networking/what-is-an-edge-router.html) that makes publishing your services an easy experience. It receives requests and finds out which components are responsible for handling them. 

In Dokploy, Traefik acts as the modern [HTTP reverse proxy](https://www.cloudflare.com/learning/cdn/glossary/reverse-proxy/) and [load balancer](https://www.cloudflare.com/learning/performance/what-is-load-balancing/) that facilitates seamless routing of requests to the various deployed applications. It plays a crucial role in Dokploy's architecture by automatically discovering services and configuring routes, thanks to its integration with Docker. 

This eliminates the need for manual configuration updates when applications are scaled up or down, or when new services are introduced. Traefik's dynamic capabilities allow it to efficiently manage incoming traffic, ensuring requests are directed to the correct application containers and enabling features like [SSL/TLS](https://www.cloudflare.com/learning/ssl/how-does-ssl-work/) termination, request routing based on hostnames or paths, and load balancing across multiple instances of an application. 

In essence, Traefik acts as the intelligent traffic controller within Dokploy, making deployments more robust, scalable, and easier to manage.

## TailScale
[Tailscale](https://tailscale.com) is a [Mesh VPN](https://tailscale.com/learn/understanding-mesh-vpns) service designed to simplify and secure connections between devices and services across various networks.

Unlike traditional VPNs that often route all traffic through a central server, Tailscale creates a peer-to-peer ["tailnet"](https://tailscale.com/kb/1136/tailnet) where each authorized device can communicate directly and securely with others using the WireGuard protocol. This approach results in lower latency and higher throughput, making it highly efficient for [remote access](https://nordvpn.com/blog/what-is-remote-access/), [site-to-site networking](https://tailscale.com/kb/1214/site-to-site), and multi-cloud environments. 

Tailscale integrates with existing identity providers for user authentication and emphasizes a zero-config setup, aiming to provide strong end-to-end encryption and a robust security model without complex manual configurations.

## Why?
Integrating Dokploy and its services with Tailscale offers substantial benefits in terms of security and network management, particularly for distributed deployments. 

Dokploy streamlines the deployment and orchestration of applications, which often entails exposing various services. By situating these services behind a Tailscale network, you establish a secure, private network that connects Dokploy instances or deployed applications across diverse servers or cloud providers, bypassing the complexities of traditional VPN setups. 

This approach effectively removes your Dokploy instances and their managed applications from direct exposure to the public internet, thereby significantly reducing the attack surface and mitigating risks associated with unauthorized access.

Furthermore, Tailscale, functioning as a Mesh VPN, simplifies secure communication between various components of a Dokploy-managed infrastructure, even when geographically dispersed.

All authorized devices within the Tailscale network can communicate directly and securely. While not a direct component of Dokploy's immediate deployment mechanism like Traefik, Tailscale significantly enhances the security and networking capabilities for more intricate or distributed Dokploy deployments, ensuring that only authenticated devices within your private Tailscale network can discover and interact with your Dokploy services.

# How
Hiding Dokploy and its services behind Tailscale's network offers significant benefits in terms of security and simplified access. 

Firstly, it creates a secure, private network for your services, shielding them from direct exposure to the public internet. This reduces the attack surface, as your Dokploy instances are not openly accessible to anyone on the web. 

Tailscale acts as a mesh VPN, allowing your devices to connect securely across different networks without the need for traditional port forwarding or complex firewall rules. This "security by design" approach means that only authenticated and authorized devices within your Tailscale network can reach your Dokploy services, making them inherently more secure against external threats.

Secondly, Tailscale streamlines the process of managing TLS certificates for your Dokploy services, especially when combined with a reverse proxy like Traefik. 

Traefik versions 3.0 and later offer native support for Tailscale as a TLS certificate resolver. This integration allows Traefik to automatically obtain and renew HTTPS certificates from Let's Encrypt for your services, using Tailscale's capabilities. This eliminates the manual overhead of certificate management and ensures that your Dokploy applications are always served over a secure, encrypted connection (HTTPS). 

Furthermore, this setup facilitates easy access to your services using user-friendly `.ts.net` domains while maintaining the security benefits of being hidden from the public internet.

## Caveats
While utilizing Tailscale's `*.ts.net` domains with path-based or port-based routing offers a straightforward way to access your Dokploy services within your secure tailnet, opting for custom domains or subdomains provides significant advantages in both security and ease of use, especially for services intended for a wider audience or for long-term production deployments.

Using path-based and port-based routing simplify the initial setup by leveraging a single `*.ts.net` endpoint, however they can lead to less intuitive URLs and potential conflicts if not meticulously managed, making it harder for users to navigate or remember specific service addresses.

In contrast, leveraging custom domains or subdomains, even when those domains are routed through Traefik and ultimately served by services within your Tailscale network, offers a more robust and user-friendly experience. 

Custom domains allow you to implement additional layers of security, such as DNS-based filtering, Web Application Firewalls (WAFs) outside of Tailscale, or more granular access controls at the domain level before traffic even reaches your Tailscale network. 

From an ease-of-use perspective, custom domains provide cleaner, more memorable URLs (e.g., app.yourdomain.com instead of dokploy-server.my-tailnet.ts.net/app). While Tailscale's [MagicDNS](https://tailscale.com/kb/1081/magicdns) is convenient, custom domains offer a more professional and intuitive appearance for users within your tailnet, simplifying access and integration with other domain-centric services.

While this blog post demonstrates the simplicity of `*.ts.net` domains, I am actively working on another blog post that details the setup for custom subdomains (which also applies to full domains), offering these enhanced security and usability benefits. You can follow me on my publishing channels () to get notifications on when the guide is released.
{/* TODO Add links to channels */}

# Prerequisites
To follow this guide, you'll need a Dokploy server already deployed and running. If you haven't set up Dokploy yet, you can find detailed instructions in [the official installation documentation](https://docs.dokploy.com/docs/core/installation). This guide assumes Dokploy is accessible and operational, whether on a cloud VM, a dedicated server, or even a local machine.

Additionally, you'll need an active Tailscale network. This involves having Tailscale installed and configured on your Dokploy server, as well as on any client devices from which you intend to access your Dokploy services. If you're new to Tailscale, their [Quick start guide](https://tailscale.com/kb/1017/install) is a great place to start. Ensure your Dokploy server is properly authenticated and connected to your Tailscale network.

In this guide, I will be using 2 machines, one acts as a Dokploy server and the other acts as a client (my own laptop) which consumes the services hosted on the Dokploy server. I will also be running the Tailscale client directly on the host machine for simplicity. If you're running TailScale in a Docker container or any other ways (that I do not know of), you might experience some differences when following the steps.

<details>
    <summary> The versions I'm using for this guide </summary>
    - Dokploy: `v0.24.4`
    - Tailscale (server): `1.86.0`
    - Tailscale (macOS client): `1.82.0`

    {/* TODO: carosel & shadows */}
    {/* annotation color: #9400ff */}
    <img src="/250727-hide-dokploy-self-hosted-services-behind-tailscale/dokploy-version.png" alt="dokploy version" className={"mx-auto"}/>
    <img src="/250727-hide-dokploy-self-hosted-services-behind-tailscale/tailscale-server-version.png" alt="tailscale server version" className={"mx-auto"}/>
    <img src="/250727-hide-dokploy-self-hosted-services-behind-tailscale/tailscale-client-version.png" alt="tailscale client version" className={"mx-auto"}/>
</details>
<br/>

# Steps
## Enable TailScale's MagicDNS
<details>
    <summary>What? Why?</summary>

    **MagicDNS** is a built-in feature of **Tailscale** that provides a private, automatic **DNS resolution service** for devices on your Tailnet. Instead of relying on traditional **DNS servers** to resolve hostnames to IP addresses, **MagicDNS** dynamically assigns and updates internal domain names (e.g., `my-server.your-tailnet-name.ts.net`) to the ephemeral 100.x.y.z IP addresses of your Tailscale devices. 

    We use MagicDNS with `*.ts.net` domains because it significantly simplifies the process of obtaining and managing **SSL certificates** for our internal domain, as Traefik can [integrate directly with the Tailscale daemon](https://tailscale.com/kb/1234/traefik-certificates) to provision certificates for `*.ts.net` hostnames, ensuring **secure HTTPS communication** for your private services without needing **external DNS validation**.
</details>
<br/>

Go to [TailScale's DNS Setting Page](https://login.tailscale.com/admin/dns) page, go to the **MagicDNS section** and click the **Enable MagicDNS** button. The result should look like this:
<img src="/250727-hide-dokploy-self-hosted-services-behind-tailscale/magic-dns.png" alt="tailscale magicdns" className={"mx-auto"}/>

## Main
{/* TODO tailscale cert Provider */}
{/* TODO Dokploy */}
{/* TODO Individual services */}

## Public services
Probably nothing special.